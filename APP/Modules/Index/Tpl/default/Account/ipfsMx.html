<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- saved from url=(0049)http://porter.weiyinstudio.com/Home/Myuser/jihuo2/zt/0/ -->

<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



	<meta name="robots" content="noindex,nofollow">

	<meta name="robots" content="noarchive">

	<!-- 屏蔽-->

	<title>ipfs账户明细</title>

	<meta name="keywords" content=" ">

	<meta name="viewport" content="initial-scale=1, maximum-scale=1">

	<meta name="apple-mobile-web-app-capable" content="yes">

	<meta name="apple-mobile-web-app-status-bar-style" content="black">

	<meta content="IE=9; IE=EDGE" http-equiv="X-UA-Compatible">

	<link rel="stylesheet" href="/Public/ybt/css/sm.css">

	<script src="/Public/ybt/js/jquery-1.10.2.min.js"></script>



	<link rel="stylesheet" href="/Public/ybt/css/sm-extend.css">



	<link rel="stylesheet" href="/Public/ybt/css/iconfont.css">

	<!--自定义-->

	<link rel="stylesheet" href="/Public/ybt/css/main.css">

	<link rel="stylesheet" href="/Public/ybt/css/order.css">
	<style>
	.receive{
		color: white;
		margin:0 0 1.5rem 0.5rem;
	}
	.Bar { position: relative; width: 100%;
		/* 宽度 */ 
		background: #DBD9D9;
		border-radius: 10px;}

	.Bar div{ display: block; position: relative;
		background:#3987F3;/* 进度条背景颜色 */ color: #333333;
		height: 6px; /* 高度 */ line-height: 6px;
		border-radius: 6px;
		/* 必须和高度一致，文本才能垂直居中 */ }
	.Bar div span{ position: absolute; width: 100%;
		/* 宽度 */ text-align: center; font-weight: bold; }
	hr{height:1px;border:none;border-top:1px solid #fff;width:1rem}
	.line_m{text-decoration:line-through;width:1rem}
	table tr td {line-height: 2rem;}
	.logo{position: absolute;top:0;left:0}
	.chartbtn{font-size:11px;border-radius:6px;border:none;background-color:#C6C4CA;padding:0 3px}
	.chartbtna{background-color:#4099FC}
	.detail-div{width:90%;margin: 0 auto;min-height:50px;line-height;overflow:hidden;linear-gradient(left,#2B60C6,#1748A5);background-image: -webkit-linear-gradient(left,#2B60C6,#1748A5);color:#fff;border-radius:0 0 5px 5px;padding:10px}
	/*.detail-div ul{padding: 0 15px;}*/
	/*.detail-div ul li{height: 48px;margin: 12px 0;}*/
	/*.detail-div ul li p{height: 50%;width: 100%;line-height: 24px;}*/
	/*.first-text .detail-topic{color: #fff;font-size: 16px;float: left;}*/
	/*.first-text .detail-num{color: #F3AA5D;font-size: 16px;float: right;}*/
	/*.second-text .detail-topic{color: #D6D6D6;font-size: 14px;float: left;}*/
	/*.second-text .detail-num{color: #D6D6D6;font-size: 14px;float: right;}*/
	/*.lefttab{height:100%;line-height:1.8rem;font-size:0.7rem;color:#fff;display:block;width:50%;float:left;border:2px solid #1748A5;border-radius:10px 0 0 10px}*/
	/*.righttab{height:100%;line-height:1.8rem;font-size:0.7rem;color:#fff;display:block;width:50%;float:left;border:2px solid #1748A5;border-radius:0 10px 10px 0}*/
	/*.lefttab.active,.righttab.active{background:rgba(23, 72, 165, 1);}*/
	.my-active{background:rgba(23, 72, 165, 1);}
	.detail-top{
		border-top-left-radius: 5px;
		border-top-right-radius: 5px;
		/*background: url('/Public/ybt/image/center/with/fang1.png') no-repeat;*/
		background: rgba(23, 72, 165, 1);
		/*background-size: 100% 100%;*/
		height:48px;
		line-height: 48px;
		width:90%;
		position: relative;
		padding:0 20px;
		overflow: hidden;
		margin: 0 auto;
	}
		
	.detail-top p span:first-child{
		color:#fff;
		float: left;
		margin-left: 15px;
	}
		
	.detail-top p span:nth-child(2){
		color:#36b0ea;
		font-size: 13px;
		float: right;
	}
	.stright-line{
		height:40%;
		background: #fff;
		width:5px;
		border-radius: 10px;
		position: absolute;
		margin-top: -9.5px;
		top:50%;
	}
	</style>
</head>

<body style="background: url('/Public/ybt/image/bg_index@2x.png') no-repeat top center; background-size:100%;">



<!--    <div class="page">-->



<!-- 标题栏 -->

<div class="bar bar-nav" style="background:url('/Public/ybt/image/header@2x.png')  no-repeat top center; background-size:cover;min-height:230px;overflow:hidden;position:relative">



	<a style="position: none;z-index: 19;width: 100%;text-align: center;display: inline-block;line-height: 50px;font-size: 0.85rem; color:#FFF;">IPFS币</a>
	<div class="logo">
		<a  href="javascript:history.go(-1)"><i class="icon icon-left"></i></a>
	</div>
	<div style="width:90%;margin:auto;">
		<div style="width:40%;margin:auto;color:#D6D6D6">
			<div style="width:25%;float:left;text-align:right;border-top:1px solid #fff;margin-top:0.75rem"></div>
			<div style="width:50%;float:left;text-align:center;height:1.5rem;line-height:1.5rem;font-size:0.85rem">数量</div>
			<div style="width:25%;float:left;text-align:left;border-top:1px solid #fff;margin-top:0.75rem"></div>
		</div>
		<div style="width:100%;float:left;text-align:center;margin-bottom:1rem">
			<p style="font-size:1.6rem;line-height:2rem">{$ipfs}</p>
		</div>
	</div>
	<div style="position:none;margin:0 1rem;text-align:center;margin-top:1rem">
		<div style="width:50%;float:left;border-right:1px solid #fff">
			<p style="font-size:1.2rem;line-height:2rem"> {$total_yesterday_profit} </p>
			<p style="font-size:0.6rem;line-height:1.5rem">昨日收益（FIL）</p>
		</div>
		<div style="width:50%;float:left;border-left:1px solid #fff">
			<p style="font-size:1.2rem;line-height:2rem"> {$total_fh_profit} </p>
			<p style="font-size:0.6rem;line-height:1.5rem">分红收益（FIL）</p>
		</div>
	</div>
	<a class="icon pull-right open-panel"></a>
</div>
<div class="content" id="main_content" style="margin-top:180px;margin-bottom:10px">
<div style="position:relative;top:18px;left:100px;z-index:100000;width:100px;height:0px">
	<button class="chartbtn chartbtna" onclick="changechart(1,this)">近一周</button>
	<button class="chartbtn" onclick="changechart(2,this)">近一月</button>
</div>


<div id="line" style="height:200px;background:url('/Public/ybt/image/header@2x.png')  no-repeat top center;margin-top:10px"></div>
<div class="" style="width:50%;margin:0.5rem 25%;color:#fff;height:2rem;text-align:center;border-radius:10px;overflow:hidden;padding:0">

		<a href="javascript:;" onclick="listin(this);" mynumber="1" class="my-active" style="height:100%;line-height:1.8rem;font-size:0.7rem;color:#fff;display:block;width:50%;float:left;border:2px solid #1748A5;border-radius:10px 0 0 10px">收入</a>

		<a href="javascript:;" onclick="listout(this);" mynumber="0" style="height:100%;line-height:1.8rem;font-size:0.7rem;color:#fff;display:block;width:50%;float:left;border:2px solid #1748A5;border-radius:0 10px 10px 0">支出</a>
	</div>

	<!--<div class="" style="width:50%;margin:1rem 25%;color:#fff;height:2rem;text-align:center;border-radius:10px;overflow:hidden;padding:0">-->

		<!--<a href="{:U('Index/Shop/orderlist')}" class="active button">正常矿机({$kjnum})</a>-->

		<!--<a href="{:U('Index/Shop/daoqi')}" class=" button">到期矿机</a>-->

	<!--	<a href="javascript:;" class="tab lefttab active">收入</a>-->

	<!--	<a href="javascript:;" class="tab righttab">支出</a>-->
	<!--</div>-->
<div class="detail-top">
	<div class="stright-line"></div>
	<p><span>明细</span><span id="date">选择日期</span></p>
</div>
	<div class="tabs">
		<!--class card-->
		<div class="detail-div" id="content-detail-list">
			<ul id="detail-list">
				<foreach name="list" item="vo">
				<li>
					<div style="padding:10px 0;min-height:3rem;overflow:hidden;margin-bottom:0;border-bottom:1px solid #e6e6e6">
						<div style="width:70%;float:left">
							<p style="font-size:0.8rem;line-height:1.5rem;">{$vo.desc}</p>
							<p style="font-size:0.7rem;line-height:1.5rem;color:#e6e6e6">{$vo.addtime|date='Y-m-d H:i:s',###}</p>
						</div>
						<div style="width:30%;float:left">
							<if condition="$vo.adds == 0 && $vo.reduce != 0">
								<p style="font-size:1rem;line-height:3rem;text-align:right;color:#dc6e5d">-{$vo.reduce|round=4}</p>
							<else />
							<p style="font-size:1rem;line-height:3rem;text-align:right;color:#4099Fc">+{$vo.adds|round=4}</p>
							</if>
						</div>
					</div>
				</li>
				</foreach>
				<if condition="$list == null"><p style="text-align:center;color:#ccc;font-size:12px;">暂无记录</p></if>
			</ul>
			<div id="no-more" style="text-align: center;color:#ccc;font-size:12px;display:none;line-height:2rem">到底了</div>
		</div>

	</div>

<br>
</div>
</body>

<script src="/Public/ybt/js/echarts.min.js"></script>
<script>
var thedata1 = {};
var thedata2 = {};
function getthedata1(){
	$.ajax({
		url: "/index/account/ipfschart",
		type: "GET",
		data: {t:1},
		async: false,
		success: function(res){
			thedata1 = res;
		}
	})
}

function getthedata2(){
	$.ajax({
		url: "/index/account/ipfschart",
		type: "GET",
		data: {t:2},
		async: false,
		success: function(res){
			thedata2 = res;
		}
	})
}


var myChart = echarts.init(document.getElementById('line'))
var option = {
	title:{
		text: "IPFS成交量",
		textStyle:{
			color: "#fff",
			fontWeight: "lighter",
			fontSize: 16,
		},
		padding: [10,15]
	},
	tooltip : {
        trigger: 'axis'
    },
	grid: {
        top: '20%',
        left: "15%",
        bottom: "15%"
    },
    legend: {
        data: [{
		    name: '收入',
		    // 强制设置图形为圆。
		    textStyle: {
		        color: '#4099FC'
		    }
		},{
		    name: '支出',
		    // 强制设置图形为圆。
		    textStyle: {
		        color: '#F3AA5D'
		    }
		}],
        right:"3%",
        top:"4%"
    },
    xAxis: {
        axisLine: {
            lineStyle: {
                color: "#fff",
            }
        },
        type: 'category',
        boundaryGap: false,
        data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
        splitLine: {
            show: false
        }
    },
    yAxis: {
        type: 'value',
        axisLine: {
            lineStyle: {
                color: "#fff",
            }
        },
        splitLine: {
            show: false
        }
    },
    series: [{
    	name: "收入",
        data: [12, 24, 15, 25, 14, 25, 16],
        symbolSize:8,
        smooth: true,
        lineStyle:{
        	color: "#4099FC"
        },
        type: 'line'
    },{
    	name: "支出",
    	symbolSize:8,
    	smooth: true,
    	lineStyle:{
        	color: "#F3AA5D"
        },
        data: [26, 12, 23, 16, 26, 17, 21],
        type: 'line'
    }]
};
myChart.setOption(option);
changechart(1,$(".chartbtn.chartbtna")[0]);
var width = document.body.clientWidth;
//自适应宽度
if (width >= 480){
	$(".bar.bar-nav").css("min-height","260px");
	$("#main_content").css("margin-top","200px");
}

function changechart(t,obj){
	$(".chartbtn").removeClass("chartbtna");
	$(obj).addClass("chartbtna");
	if (t == 1){
		getthedata1();
		option.series[0].data = thedata1.adds
		option.series[1].data = thedata1.reduce
		option.xAxis.data = thedata1.datearray;
	}else if (t == 2){
		getthedata2();
		option.series[0].data = thedata2.adds
		option.series[1].data = thedata2.reduce
		option.xAxis.data = thedata2.datearray;
	}
	myChart.setOption(option);
}

$(".tab").click(function(){
	$(".tab").removeClass("active");
	$(this).addClass("active")
})
</script>
<script type="text/javascript" src="/Public/ybt/js/jquery-3.3.1/jquery-3.3.1.js"></script>
<script type="text/javascript" src="/Public/ybt/js/layer/mobile/layer.js"></script>
<script type="text/html" id="demo">
    <%for(var i=0;i < info.length; i++){%>
    <li>
		<div style="padding:10px 0;min-height:3rem;overflow:hidden;margin-bottom:0;border-bottom:1px solid #e6e6e6">
			<div style="width:70%;float:left">
				<p style="font-size:0.8rem;line-height:1.5rem;"><%=info[i].desc%></p>
				<p style="font-size:0.7rem;line-height:1.5rem;color:#e6e6e6"><%=getTime(info[i].addtime)%></p>
			</div>
			<div style="width:30%;float:left">
				<%if(info[i].adds == 0){%>
			        <p style="font-size:1rem;line-height:3rem;text-align:right;color:#dc6e5d">-<%=info[i].reduce%></p>
			    <%}else{%>
			        <p style="font-size:1rem;line-height:3rem;text-align:right;color:#4099Fc">+<%=info[i].adds%></p>
			    <%}%>
			</div>
		</div>
	</li>
    <%}%>
</script>


<script type="text/javascript" src="/Public/ybt/js/template-native.js"></script>
<script type="text/javascript">
    $(function(){
        template.helper('getTime',function(timer){
            return getLocalTime(timer);
        });
    });
	var type = 1;	//1为收入，2为支出
	var pagelen = 8;	//单页行数
	//支出
	function listout(e){
		$('#date').html('选择日期');
		$('#no-more').hide();
		$(e).addClass('my-active');
		$(e).prev().removeClass('my-active');
		type = 0;
		$.post("{:U(GROUP_NAME.'/account/ipfslist')}",{type:type},function(res){
			if(res.info==null){
				$('#detail-list').html('<p style="text-align:center;color:#ccc;font-size:12px;line-height:1rem">暂无记录</p>');
                // $('#load').hide();
                // $('#no-more').show();
                return;
            }
            var html = template('demo',res);
            $('#detail-list').html(html);
            var infolen = res.info.length;
            if(infolen%pagelen != 0) {
            	$('#no-more').show();
                return;
            }
		});
	}
	
	//收入
	function listin(e){
		$('#date').html('选择日期');
		$('#no-more').hide();
		$(e).addClass('my-active');
		$(e).next().removeClass('my-active');
		type = 1;
		$.post("{:U(GROUP_NAME.'/account/ipfslist')}",{type:type},function(res){
			if(res.info==null){
				$('#detail-list').html('<p style="text-align:center;color:#ccc;font-size:12px;line-height:1rem">暂无记录</p>');
                // $('#load').hide();
                // $('#no-more').show();
                return;
            }
            var html = template('demo',res);
            $('#detail-list').html(html);
            var infolen = res.info.length;
            if(infolen%pagelen != 0) {
            	$('#no-more').show();
                return;
            }
		})
	}
	
	$lasttime = 0;
    $('#main_content').on("scroll", function () {
        var no_more = document.getElementById('no-more');
        if (no_more.style.display != 'block') {
            $("#load").show();
        }
        console.log(Math.ceil($(this).scrollTop()));
        console.log($(this).innerHeight());
        console.log($(this)[0].scrollHeight);
        console.log('------');
        // var len = $('#content-detail-list ul li').length;
        // len = len/pagelen;
        // console.log('len-'+len);
        // if (len%1 != 0) {
        //     $('#load').hide();
        //     $('#no-more').show();
        //     return;
        // }
        
        if (Math.ceil($(this).scrollTop()) + $(this).innerHeight() >= $(this)[0].scrollHeight) {
        	console.log('---1---');
        	$nowtime = Date.parse(new Date()); //1514736000000
	        if($nowtime - $lasttime < 200) {
	        	return;	//200毫秒内只加载一次
	        }
	        $lasttime = $nowtime;
            var url = "{:U(GROUP_NAME.'/account/ipfslist')}"
            var len = $('#content-detail-list ul li').length;
            len = len/pagelen;
            // console.log(len);
            if (len%1 != 0) {
                $('#load').hide();
                $('#no-more').show();
                return;
            }
            var page = len+1;
            var date = $('#date').html();
            if(date == '选择日期') {
            	date = 0;
            }
            var select = $("option:selected");
            if (select.index() == 0) {
                $.post(url,{page:page,type:type,date:date},function(res){
                    if(res.info==null){
                        $('#load').hide();
                        $('#no-more').show();
                        return;
                    }
                    var html = template('demo',res);
                    $('#detail-list').append(html);
                });
            }else{
                $.post(url,{page:page,type:type,date:date,time:select.val()},function(res){
                    if(res.info==null){
                        $('#load').hide();
                        $('#no-more').show();
                        return;
                    }
                    var html = template('demo',res);
                    $('#detail-list').append(html);
                }); 
            }
        }
    });

    function select(){
        var select = $("option:selected");
        if (select.index() == 0) {
            $('.select-time').css('color','#ccc');
        }else{
            $('.select-time').css('color','#000');
            $('option:first-child').css('color','#ccc');
            $('#no-more').hide();
            $("#no-operation").hide();

            if (select.val() == 15) {
                $('#no-more').text("暂无更多记录");
            }
            if (select.val() == 30) {
                $('#no-more').text("暂无更多记录");
            }
            if (select.val() == 90) {
                $('#no-more').text("暂无更多记录");
            }

            var url = "{:U(GROUP_NAME.'/Ptb/selectTime')}"
            $.post(url,{time:select.val()},function(res){
                if (res.info == null) {
                    $('#no-more').show();
                    return;
                }
                var html = template('demo',res);
                $('#detail-list').html(html);    
            });
        }

    }

</script>
<script type="text/javascript" src="/Public/ybt/js/rolldate/rolldate.min.js"></script>
<script type="text/javascript">
	// var Rolldate = require('rolldate');
	new Rolldate({
	  el:'#date',
	  confirm:function(date){
	  	$('#no-more').hide();
	  	var type = $('.my-active').attr('mynumber');
	  	$.post("{:U(GROUP_NAME.'/account/ipfslist')}",{type:type,date:date},function(res){
	  		if(res.info==null){
				$('#detail-list').html('<p style="text-align:center;color:#ccc;font-size:12px;line-height:1rem">暂无记录</p>');
                // $('#load').hide();
                // $('#no-more').show();
                return;
            }
            var html = template('demo',res);
            $('#detail-list').html(html);
            var infolen = res.info.length;
            if(infolen%pagelen != 0) {
            	$('#no-more').show();
                return;
            }
	  	});
	  }
	});
</script>
</html>